### 1. 功能背景
目前要增加新用户只能通过管理员手动在组织架构中邀请或导入excle文档来实现，比较麻烦。考虑增加发送注册链接让用户自行注册后自动加入工作区的功能，以此减轻管理员的工作量。

### 2. 如何区分工作区特定的登录/注册URL
普通的登录/注册链接：
```
/steedos/sign-in
/steedos/sign-up
```
工作区特定的的登录/注册链接：
```
/steedos/sign-in?spaceId=53215960334904539e00121a
/steedos/sign-up?spaceId=53215960334904539e00121a
```
带redirect参数的登录/注册链接：
```
/steedos/sign-in?redirect=xxx
/steedos/sign-in?spaceId=53215960334904539e00121a&redirect=xxx
```
>上述URL参数中的spaceId表示特定工作区的ID，redirect表示登录后要重定向的URL。

> 手机号登录界面的URL始终是`/steedos/setup/phone`，但是如果从工作区特定的的登录/注册链接中打开过，那么就是按特定工作区登录规则登录进系统。

### 3. 登录/注册界面个性化
### 3.1. 界面顶部LOGO图标个性化
- 普通的登录/注册界面统一显示我们华炎办公的LOGO图标。
- 工作区特定的登录/注册界面如果关联工作区没有设置过工作区LOGO，则也统一显示我们华炎办公的LOGO图标。
- 工作区特定的登录/注册界面如果关联工作区有设置过工作区LOGO，则显示特定的工作区LOGO图标。

### 3.2. 特定工作区登录功能规则
- 输入用户名密码登录成功后，如果当前用户不属于该工作区，则不会自动把用户加入该工作区。
- 输入用户名密码登录成功后，当前用户如果属于该工作区，会自动选中当前所处工作区为该工作区，如果不属于，则选中第一个工作区。

### 3.3. 特定工作区注册功能规则
- 如果是新用户(users表中没有该用户)注册，则注册后自动加入工作区并登录。
- 如果是老用户(users表中有该用户)注册，则不允许注册(目前只能通过管理员手动在组织架构中邀请或导入excle文档来实现)。
- 自动加入工作区的用户，space_users表中标记user_accepted为默认值true。

### 3.4. 关于自动加入工作区安全性问题的考虑
> 说明：以上3.2、3.3规则中只要拿到工作区特定的登录/注册链接，就可以不经过管理员同意自动加入该工作区，并登录操作数据，存在安全性问题。

- 经参考企业微信，它是直接发了邀请链接（链接只能发送到微信聊天窗口中，可以是个人聊天窗口也可以是群聊天窗口）后，被邀请的人点击链接就可以直接加入了，其安全性应该是由管理员直接把握，不需要管理员二次确认，发现有问题的人可以从通讯录中把问题账户直接删除。
- 管理员可以随时在组织架构中把有问题的用户设置为无效用户(user_accepted设置为false)或直接删除该用户以禁止该用户进入该工作区。
- 我们另外为工作区增加了一个属性【是否允许注册】，该属性选中的情况下才允许显示注册按钮，否则不显示

> 当带了spaceId参数时，登录界面底下的注册链接应该变成"免费注册"而不是“企业注册”（除非该工作区被设置为禁止注册用户）

### 4. 登录/注册界面链接路由跳转及刷新时是否为特定工作区相关规则
- 当在带spaceId参数的工作区特定的登录/注册URL中，无论怎么跳转(比如跳转到手机号登录界面、忘记密码界面等)和刷新，其spaceId参数都不会丢失（因为spaceId参数记录到本地存储中了），即使在不带spaceId参数的界面(如手机号登录界面)刷新也不会让spaceId参数丢失。
- 只要打开过带spaceId参数的工作区特定的登录/注册URL，那么就始终被记住为该工作区登录/注册，即使登出系统也一样会跳转到保持该spaceId参数的登录界面。
- 如果打开过带spaceId参数的工作区特定的登录/注册URL，只能通过手动把URL中带的spaceId参数删除并回车刷新界面来还原到普通的登录/注册功能中。
> 手动把URL中带的spaceId参数删除指的是把上述浏览器URL改为【/steedos/sign-in?spaceId=】来清除之前保存的spaceId，改为【/steedos/sign-in】是没有效果的。
