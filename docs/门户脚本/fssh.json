{
  "version": 1,
  "allow_edit": true,
  "plugins": [
    "/views/board/tutorial.min.js",
    "/plugins/all"
  ],
  "panes": [
    {
      "title": "pane1",
      "width": 1,
      "row": {
        "2": 1,
        "3": 5,
        "4": 1,
        "5": 33
      },
      "col": {
        "2": 1,
        "3": 1,
        "4": 3,
        "5": -9
      },
      "col_width": "2",
      "widgets": [
        {
          "type": "plugin531a3b2b7df9e78c7300000f",
          "settings": {
            "html": "var newResultArr = [];\n// 发送推送通知消息\nPortal.Events.nodeNotify = function(appID,isIE,title,text){\n    var exec = nw.require('child_process').exec;\n    var options = {\n        iconUrl: Meteor.absoluteUrl() + \"images/apps/workflow/AppIcon48x48.png\",\n        title: title,\n        body: text,\n        timeout: 6 * 1000\n    }\n    options.onclick = function(){\n        var app_id = appID;\n        var aToken = Accounts._storedLoginToken();\n        var uId = Meteor.userId();\n        var path = \"api/app/sso/\" + app_id + \"?authToken=\" + aToken + \"&userId=\" + uId;\n        var openUrl = Meteor.absoluteUrl(path);\n        if(isIE){\n            var cmd = \"start iexplore.exe \\\"\" + openUrl + \"\\\"\";\n            exec(cmd, function(error, stdout, stderr){\n                if(error){\n                    toastr.error(error);\n                }\n            });\n        }else{\n            if(app_id == \"YvyxQqm3c7WccLdHQ\")\n            \tPortal.Events.tryto_login_cmsPtr();\n            if(app_id == \"Nk6zgMo8L8zsTXrvn\")\n                Portal.Events.tryto_login_cmsCnpc();\n        }\n    }\n    $.notification(options);\n    msg = new Audio(\"/sound/notification.mp3\");\n    msg.play();\n    return;\n}\n\nPortal.Events.judgeResult = function(oResult,nResult){\n    var arr = [];\n    var oldDataArray = $(oResult).find(\"TaskDate\").toArray();\n    var newDataArray = $(nResult).find(\"TaskDate\");\n    if(nResult.length > 0){\n        //arr.splice(0,newResultArr.length);\n        for(var i = 0; i < newDataArray.length; i++){\n            // 判断是否有新待办\n            var exist = oldDataArray.map(function(n){\n                return $(n).text();\n            }).includes(newDataArray.eq(i).text());\n            // 将新待办添加到数组中\n            if(exist == false){\n                arr.push($(nResult).find(\"Title\").text());\n            }\n        }\n    }\n    return arr;\n}\n\n// 判断是否有新待办数据\nPortal.Events.callBackForAjax = function(datasourceName,oldResult,newResult){\n    var oldDataArray, newDataArray, isIE;\n    if(!oldResult)\n        return;\n    switch (datasourceName){\n        case \"CMS_CNPC_GetMyTask\":\n            isIE = true;\n            oldDataArray = $(oldResult).find(\"Table\");\n            newDataArray = $(newResult).find(\"Table\");\n\t\t\tvar dataArr = Portal.Events.judgeResult(oldDataArray,newDataArray);\n            if (dataArr.length > 0){\n                var title = \"集团合同系统\";\n                var text; \n                if (dataArr.length > 1){\n                \ttext = \"您有\" + dataArr.length + \"条待办未处理\";\n                }else{\n                    text = dataArr[0];\n                }\n                Portal.Events.nodeNotify(\"Nk6zgMo8L8zsTXrvn\",isIE,title,text);\n            }\n        \tbreak;\n        case \"CMS_PTR_GetMyTask\":\n            isIE = true;\n            oldDataArray = $(oldResult).find(\"Table\");\n            newDataArray = $(newResult).find(\"Table\");\n\t\t\tvar dataArr = Portal.Events.judgeResult(oldDataArray,newDataArray);\n            if (dataArr.length > 0){\n                var title = \"股份合同系统\";\n                var text; \n                if (dataArr.length > 1){\n                \ttext = \"您有\" + dataArr.length + \"条待办未处理\";\n                }else{\n                    text = dataArr[0];\n                }\n                Portal.Events.nodeNotify(\"YvyxQqm3c7WccLdHQ\",isIE,title,text);\n            }\n        \tbreak;\n        case \"EXPENSE_CNPC_GetMyTask\":\n            isIE = false;\n            oldDataArray = $(oldResult).find(\"Table1\")\n            newDataArray = $(newResult).find(\"Table1\");\n\t\t\tvar dataArr = Portal.Events.judgeResult(oldDataArray,newDataArray);\n            if (dataArr.length > 0){\n                var title = \"集团集中报销系统\";\n                var text; \n                if (dataArr.length > 1){\n                \ttext = \"您有\" + dataArr.length + \"条待办未处理\";\n                }else{\n                    text = dataArr[0];\n                }\n                Portal.Events.nodeNotify(\"N5AGX983LGgEm4a25\",isIE,title,text);\n            }\n        \tbreak;\n        case \"EXPENSE_PTR_GetMyTask\":\n            isIE = false;\n            oldDataArray = $(oldResult).find(\"Table1\")\n            newDataArray = $(newResult).find(\"Table1\");\n\t\t\tvar dataArr = Portal.Events.judgeResult(oldDataArray,newDataArray);\n            if (dataArr.length > 0){\n                var title = \"股份集中报销系统\";\n                var text; \n                if (dataArr.length > 1){\n                \ttext = \"您有\" + dataArr.length + \"条待办未处理\";\n                }else{\n                    text = dataArr[0];\n                }\n                Portal.Events.nodeNotify(\"nHMsG3k26PeB7uDsm\",isIE,title,text);\n            }\n        \tbreak;\n        case \"OA_GetMyTask\":\n            isIE = true;\n            oldDataArray = $(oldResult).find(\"Table\");\n            newDataArray = $(newResult).find(\"Table\");\n\t\t\tvar dataArr = Portal.Events.judgeResult(oldDataArray,newDataArray);\n            if (dataArr.length > 0){\n                var title = \"电子公文-待办\";\n                var text; \n                if (dataArr.length > 1){\n                \ttext = \"您有\" + dataArr.length + \"条待办未处理\";\n                }else{\n                    text = dataArr[0];\n                }\n                Portal.Events.nodeNotify(\"SJ7baMwJkbSfjSist\",isIE,title,text);\n            }\n        \tbreak;\n        case \"OA_PASS_GetMyTask\":\n            isIE = true;\n            oldDataArray = $(oldResult).find(\"Table\");\n            newDataArray = $(newResult).find(\"Table\");\n\t\t\tvar dataArr = Portal.Events.judgeResult(oldDataArray,newDataArray);\n            if (dataArr.length > 0){\n                var title = \"电子公文-传阅\";\n                var text; \n                if (dataArr.length > 1){\n                \ttext = \"您有\" + dataArr.length + \"条待办未处理\";\n                }else{\n                    text = dataArr[0];\n                }\n                Portal.Events.nodeNotify(\"sAxnbGqTQsGNjMpZ8\",isIE,title,text);\n            }\n        \tbreak;\n        default:\n            break;\n    }\n}\n\n//接口请求错误提示报错信息\nPortal.Events.callBackForAjaxError = function(datasourceName){\n    switch (datasourceName){\n        case \"CMS_CNPC_GetMyTask\":\n            toastr.warning(null,\"集团合同系统接口忙，稍后系统自动重新连接！\",{timeOut:2000});\n        \tbreak;\n        case \"CMS_PTR_GetMyTask\":\n            toastr.warning(null,\"股份合同系统接口忙，稍后系统自动重新连接！\",{timeOut:2000});\n        \tbreak;\n        case \"EXPENSE_CNPC_GetMyTask\":\n            toastr.warning(null,\"集团集中报销系统接口忙，稍后系统自动重新连接！\",{timeOut:2000});\n        \tbreak;\n        case \"EXPENSE_PTR_GetMyTask\":\n            toastr.warning(null,\"股份集中报销系统接口忙，稍后系统自动重新连接！\",{timeOut:2000});\n        \tbreak;\n        case \"OA_GetMyTask\":\n            toastr.warning(null,\"电子公文-待办接口忙，稍后系统自动重新连接！\",{timeOut:2000});\n        \tbreak;\n        case \"OA_PASS_GetMyTask\":\n            toastr.warning(null,\"电子公文-传阅接口忙，稍后系统自动重新连接！\",{timeOut:2000});\n        \tbreak;\n        default:\n            break;\n    }\n}\n\nPortal.Events.tryto_login_emailClient=function(is_url_href){\n    var e = window.event || arguments.callee.caller.arguments[0];\n    if (Steedos.isNode()){\n        var openUrl = \"\";\n        if(is_url_href){\n            var target = $(e.target);\n            if(target.is(\"a\"))\n                openUrl = location.origin + target.attr(\"href\");     \n            else\n                openUrl = location.origin + target.closest(\"a\").attr(\"href\");\n        }\n        nw.Window.open(openUrl,{\"show\":false},function(nWin){\n            nWin.maximize();\n        });\n    }\n    e.preventDefault();\n    return false;\n}\nvar loadingView = '<div id =\"steedosEmailjsBody\" class=\"callout callout-info radius-none box-widget\" style=\"height:312px;background-color:#68c2f1 !important\">\\\n                        <div class=\"widget-header\">\\\n                        \t<div class=\"widget-icon\"><i class=\"fa fa-fw fa-envelope\"></i></div>\\\n                        \t<div class=\"widget-title\">未读邮件</div>\\\n                        </div>\\\n                        <div class=\"widget-body is-empty\">加载中...</div>\\\n                        </div>';\n                        \nvar inbox = MailManager.getBoxBySpecialUse(\"\\\\Inbox\");\nvar refreshView = function(){\n    var mailView = \"\";\n    \n    var inboxPath = MailManager.getBoxBySpecialUse(\"\\\\Inbox\").path;\n\n    var messages = Mail.getUnseenMessages(5);\n\n    var emailjsPath = \"/emailjs/b/Inbox/\";\n    \n    mailView = '<div id =\"steedosEmailjsBody\" class=\"callout callout-info radius-none box-widget\" style=\"height:312px;background-color:#68c2f1 !important\">\\\n                        <div class=\"widget-header\"><div class=\"widget-icon\"><a href=\"'+ emailjsPath +'\"><i class=\"fa fa-fw fa-envelope\"></i></a></div>\\\n                        <div class=\"widget-title\"><a href=\"'+ emailjsPath +'\">未读邮件</a></div>\\\n                    </div>';\n\n    if(messages.length == 0){\n        mailView += '<div class=\"widget-body is-empty\">暂无未读邮件</div>';\n        mailView += \"</div>\";\n        $(\"#steedosEmailjsBody\").parent().html(mailView);\n        return mailView;\n    }else{\n        mailView +='<div class=\"widget-body\"><ul>';\n    }\n    messages.forEach(function(m,i){\n        var from = m.from[0];\n\n        var text = from.name? from.name : from.address;\n\n        var subject = m.subject? m.subject : \"\";\n\n        var url = \"/emailjs/b/\" + inboxPath + \"/\" + m.uid;\n        \n        mailView += \"<li><a onmouseover=\\\"this.style.backgroundColor='#ade4fc';this.style.color='#2ba4db';\\\" onmouseout=\\\"this.style.backgroundColor='#2ba4db';this.style.color='#fff';\\\" style=\\\"background-color: #2ba4db;display: block;margin-right: -15px;margin-left: 8px;\\\" href='\"+ url \n        \t\t\t+\"' title='\"+ subject +\"'><span class='badge' style=\\\"background:#fff;color:#68c2f1;margin-left: -10px;margin-bottom: 3px;border-radius: 25px;padding: 3px 5px;\\\">\"+ (i+1) \n        \t\t\t+\"</span><span class='text-overflow' style=\\\"padding-left:8px;width:auto;max-width:60%\\\">\"+ subject \n        \t\t\t+\"</span><i class='text-overflow' style=\\\"float:right;margin-right: 13px;padding-right:4px; width:auto;max-width:30%\\\">\"+ text +\"</i></a></li>\";\n    })\n        \n    mailView += \"<ul></div></div>\";\n   \n    $(\"#steedosEmailjsBody\").parent().html(mailView);\n    return mailView;\n    \n}\nif(!inbox){\n\tAccountManager.checkAccount(refreshView);\n    $(document.body).removeClass('loading');\n    return loadingView;\n}else{\n    AccountManager.checkAccount(refreshView);\n    $(document.body).removeClass('loading');\n    return refreshView();\n}",
            "height": 4
          }
        },
        {
          "type": "plugin531a3b2b7df9e78c7300000f",
          "settings": {
            "html": "//股份合同系统\nPortal.Events.tryto_login_cmsPtr=function(is_url_href){\n    var returnUrl = \"https://cms.petrochina/CMSProduction/Default.aspx\";\n    var e = window.event || arguments.callee.caller.arguments[0];\n    if(is_url_href){\n        var target = $(e.target);\n        var host = \"\";\n        var re=/^(\\d+)\\.(\\d+)\\.(\\d+)\\.(\\d+)$/;\n        if(target.is(\"a\"))\n            host = new URL(target.attr(\"href\"));        \n        else\n            host = new URL(target.closest(\"a\").attr(\"href\"));\n        var hostname = host.hostname;\n        if(re.test(hostname)){\n            if( RegExp.$1<256 && RegExp.$2<256 && RegExp.$3<256 && RegExp.$4<256)   \n            openUrl = host.href.replace(hostname,\"cms.petrochina\");\n        }else{\n            openUrl = host.href;\n        }\n    }\n    if(Steedos.isNode()){\n        var exec = nw.require('child_process').exec;\n        var app_id = \"YvyxQqm3c7WccLdHQ\";\n        var aToken = Accounts._storedLoginToken();\n        var uId = Meteor.userId();\n        var eurl = encodeURIComponent(returnUrl);\n        var path = \"api/app/sso/\" + app_id + \"?authToken=\" + aToken + \"&userId=\" + uId + \"&returnUrl=\" + eurl;\n        var openUrl = Meteor.absoluteUrl(path);\n        var cmd = \"start iexplore.exe \\\"\" + openUrl + \"\\\"\";\n        exec(cmd, function(error, stdout, stderr){\n            if(error){\n                toastr.error(error);\n            }\n        });\n    }\n    e.preventDefault();\n    return false;\n}\nvar cmsPtrValue;\nvar cmsPtrArray = datasources ? $(datasources[\"CMS_PTR_GetMyTask\"]).find(\"Table\") : [];\nif (cmsPtrArray.length == 0){\n    cmsPtrValue = '<div class=\"callout callout-warning radius-none widget-mini box-widget\" style=\"height:150px;background-color:#fda946 !important\">\\\n\t\t<div class=\"widget-header\" style=\"position:absolute; left:20px; width:100px\">\\\n            <div class=\"widget-icon\"><a onclick=\"Portal.Events.tryto_login_cmsPtr()\" href=\"http://cms.petrochina/CMSProduction/Login/Login.aspx\" target=\"_blank\"><i class=\"fa fa-fw  fa-dollar\"></i></a></div>\\\n\t\t\t<div class=\"widget-title\" style=\"margin-top: -15px\"><a onclick=\"Portal.Events.tryto_login_cmsPtr()\" href=\"http://cms.petrochina/CMSProduction/Login/Login.aspx\" target=\"_blank\">股份合同</a></div>\\\n        </div>\\\n\t\t<div class=\"widget-body is-empty\" style=\"text-align:left; margin-left:120px; margin-top:18px\">暂无股份合同待办</div>\\\n  </div>'\n}else{\n    cmsPtrValue = '<div class=\"callout callout-warning radius-none widget-mini box-widget\" style=\"height:150px;background-color:#fda946 !important\">\\\n    <div class=\"widget-header\" style=\"position:absolute; left:20px; width:100px\">\\\n        <div class=\"widget-icon\"><a onclick=\"Portal.Events.tryto_login_cmsPtr()\" href=\"http://cms.petrochina/CMSProduction/Login/Login.aspx\" target=\"_blank\"><i class=\"fa fa-fw  fa-dollar\"></i></a></div>\\\n        <div class=\"widget-title\" style=\"margin-top: -15px\"><a onclick=\"Portal.Events.tryto_login_cmsPtr()\" href=\"http://cms.petrochina/CMSProduction/Login/Login.aspx\" target=\"_blank\">股份合同</a></div>\\\n    </div>\\\n    <div class=\"widget-body\" style=\"text-align:left; margin-left:120px\">\\\n      <ul>\\\n           %@\\\n      </ul>\\\n    </div>\\\n  </div>';\n};\nvar cmsPtrArr = [];\nvar cmsPtrArrLength = cmsPtrArray.length;\nfor(var i = 0; i < cmsPtrArrLength; i++){\n    if (i > 2){\n        break;\n    }\n    var url = cmsPtrArray.eq(i).find(\"URL\").text();\n    var title = cmsPtrArray.eq(i).find(\"Title\").text();\n    cmsPtrArr.push(\"<li><a onclick=\\\"Portal.Events.tryto_login_cmsPtr(1)\\\" onmouseover=\\\"this.style.backgroundColor='#fcd8ae';this.style.color='#ee9831';\\\" onmouseout=\\\"this.style.backgroundColor='#ee9831';this.style.color='#fff';\\\" style='background-color: #ee9831;display: block;margin-right: -15px;margin-left: 8px;' href='\"+ url \n                 +\"' target='_blank' title='\"+ title \n                 +\"'><span class='badge' style=\\\"background:#fff;color:#ee9831;margin-left: -10px;margin-bottom: 3px;border-radius: 25px;padding: 3px 5px;\\\">\"+ (i+1) \n             +\"</span><span class='text-overflow' style=\\\"padding-left:8px;width:90%\\\">\"+ title +\"</span></a></li>\");\n};\ncmsPtrValue = cmsPtrValue.replace(\"%@\",cmsPtrArr.join(\"\"));\n\n\n// 流程审批待办\nPortal.Events.tryto_login_workflow=function(is_url_href){\n    var returnUrl = \"http://10.103.10.161/dzhsp/service/s_xt_userlogin_auto_fsshjk.aspx\";\n    var e = window.event || arguments.callee.caller.arguments[0];\n    if(Steedos.isNode()){\n        var exec = nw.require('child_process').exec;\n        var app_id = \"9k2mJ9yje5kLmFXDe\";\n        var aToken = Accounts._storedLoginToken();\n        var uId = Meteor.userId();\n        var eurl = encodeURIComponent(returnUrl);\n        var path = \"api/app/sso/\" + app_id + \"?authToken=\" + aToken + \"&userId=\" + uId + \"&returnUrl=\" + eurl;\n        var openUrl = Meteor.absoluteUrl(path);\n        var cmd = \"start iexplore.exe \\\"\" + openUrl + \"\\\"\";\n        exec(cmd, function(error, stdout, stderr){\n            if(error){\n                toastr.error(error);\n            }\n        });\n    }\n    e.preventDefault();\n    return false;\n}\nvar workflowValue;\nvar workflowArray = [];\nvar workflowXml = datasources ? $(datasources[\"Workflow_GetSiteAData\"]).find(\"GetSiteAData_xmlResult\").text() : \"\";\n//判断账户是否不存在\nif (workflowXml != \"未找到数据！\")\n\tworkflowArray = $($.parseXML(workflowXml)).find(\"row\");\n\nif ((workflowXml == \"未找到数据！\") || (workflowArray.length == 0)){\n    workflowValue = '<div class=\"callout callout-warning radius-none widget-mini box-widget\" style=\"height:150px;background-color:#68c2f1 !important\">\\\n    <div class=\"widget-header\" style=\"position:absolute; left:20px; width:100px\">\\\n        <div class=\"widget-icon\"><a onclick=\"Portal.Events.tryto_login_workflow()\" href=\"http://10.103.10.161/dzhsp/index.aspx\" target=\"_blank\"><i class=\"fa fa-fw  fa-file-text-o\"></i></a></div>\\\n        <div class=\"widget-title\" style=\"margin-top: -15px\"><a onclick=\"Portal.Events.tryto_login_workflow()\" href=\"http://10.103.10.161/dzhsp/index.aspx\" target=\"_blank\">流程审批待办</a></div></div>\\\n    <div class=\"widget-body is-empty\" style=\"text-align:left; margin-left:120px; margin-top:18px\">暂无流程审批待办</div>\\\n  </div>'\n}else{\n    workflowValue = '<div class=\"callout callout-warning radius-none widget-mini box-widget\" style=\"height:150px;background-color:#68c2f1 !important\">\\\n    <div class=\"widget-header\" style=\"position:absolute; left:20px; width:100px\">\\\n        <div class=\"widget-icon\"><a onclick=\"Portal.Events.tryto_login_workflow()\" href=\"http://10.103.10.161/dzhsp/index.aspx\" target=\"_blank\"><i class=\"fa fa-fw  fa-file-text-o\"></i></a></div>\\\n        <div class=\"widget-title\" style=\"margin-top: -15px\"><a onclick=\"Portal.Events.tryto_login_workflow()\" href=\"http://10.103.10.161/dzhsp/index.aspx\" target=\"_blank\">流程审批待办</a></div>\\\n    </div>\\\n    <div class=\"widget-body\" style=\"text-align:left; margin-left:120px\">\\\n      <ul>\\\n           %@\\\n      </ul>\\\n    </div>\\\n  </div>';\n};\nvar workflowArr = [];\nvar workflowArrLength = workflowArray.length;\nif (workflowArrLength > 0){\n    for(var i = 0; i < workflowArrLength; i++){\n        if (i > 3){\n            break;\n        }\n        var dbName = workflowArray.eq(i).find(\"dbxxName\").text();\n        var dbNum = workflowArray.eq(i).find(\"dbxxNum\").text();\n        var dbPath = workflowArray.eq(i).find(\"dbxxPath\").text();\n        var title = \"在【\" + dbName + \"】业务中有\" + dbNum + \"条数据等待审批\";\n        workflowArr.push(\"<li><a onclick=\\\"Portal.Events.tryto_login_workflow(1)\\\" onmouseover=\\\"this.style.backgroundColor='#ade4fc';this.style.color='#2ba4db';\\\" onmouseout=\\\"this.style.backgroundColor='#2ba4db';this.style.color='#fff';\\\" style='background-color: #2ba4db;display: block;margin-right: -15px;margin-left: 8px;' href='\"+ dbPath \n                     +\"' target='_blank' title='\"+ title \n                     +\"'><span class='badge' style=\\\"background:#fff;color:#31a7b3;margin-left: -10px;margin-bottom: 3px;border-radius: 25px;padding: 3px 5px;\\\">\"+ (i+1) \n                 +\"</span><span class='text-overflow' style=\\\"padding-left:8px;width:90%\\\">\"+ title +\"</span></a></li>\");\n    };\n\tworkflowValue = workflowValue.replace(\"%@\",workflowArr.join(\"\"));\n}\nreturn cmsPtrValue + workflowValue;",
            "height": 4
          }
        }
      ]
    },
    {
      "title": "pane2",
      "width": 1,
      "row": {
        "2": 19,
        "3": 1,
        "4": 19,
        "5": 7
      },
      "col": {
        "2": 1,
        "3": -17,
        "4": 3,
        "5": 1
      },
      "col_width": "2",
      "widgets": [
        {
          "type": "plugin531a3b2b7df9e78c7300000f",
          "settings": {
            "html": "Portal.Events.tryto_login_oa=function(is_url_href){\n    var returnUrl = \"http://oa.petrochina/task%20portal/index.aspx\";\n    var e = window.event || arguments.callee.caller.arguments[0];\n    if(is_url_href){\n        var target = $(e.target);\n        var host = \"\";\n        var re=/^(\\d+)\\.(\\d+)\\.(\\d+)\\.(\\d+)$/;\n        if(target.is(\"a\"))\n            host = new URL(target.attr(\"href\"));        \n        else\n            host = new URL(target.closest(\"a\").attr(\"href\"));\n        var hostname = host.hostname;\n        if(re.test(hostname)){\n            if( RegExp.$1<256 && RegExp.$2<256 && RegExp.$3<256 && RegExp.$4<256)   \n            openUrl = host.href.replace(hostname,\"oa.petrochina\");\n        }else{\n            openUrl = host.href;\n        }\n    }\n    if(Steedos.isNode()){\n        var exec = nw.require('child_process').exec;\n        var app_id = \"sAxnbGqTQsGNjMpZ8\";\n        var aToken = Accounts._storedLoginToken();\n        var uId = Meteor.userId();\n        var eurl = encodeURIComponent(returnUrl);\n        var path = \"api/app/sso/\" + app_id + \"?authToken=\" + aToken + \"&userId=\" + uId + \"&returnUrl=\" + eurl;\n        var openUrl = Meteor.absoluteUrl(path);\n        var cmd = \"start iexplore.exe \\\"\" + openUrl + \"\\\"\";\n        exec(cmd, function(error, stdout, stderr){\n            if(error){\n                toastr.error(error);\n            }\n        });\n    }\n    e.preventDefault();\n    return false;\n}\nvar dataArray = datasources ? $(datasources[\"OA_GetMyTask\"]).find(\"Table\") : [];\nif (dataArray.length == 0){\n    reValue = '<div class=\"callout callout-info radius-none box-widget\" style=\"height:312px;background-color:#85D3DC !important\">\\\n        <div class=\"widget-header\">\\\n            <div class=\"widget-icon\"><a onclick=\"Portal.Events.tryto_login_oa()\" href=\"javascript:void(0);\" target=\"_blank\"><i class=\"fa fa-fw fa-users\"></i></a></div>\\\n            <div class=\"widget-title\"><a onclick=\"Portal.Events.tryto_login_oa()\" href=\"javascript:void(0);\" target=\"_blank\">电子公文-待办</a></div>\\\n        </div>\\\n        <div class=\"widget-body is-empty\">暂无公文待办</div>\\\n    </div>'\n}else{\n    reValue = '<div class=\"callout callout-info radius-none box-widget\" style=\"height:312px;background-color:#85D3DC !important\">\\\n            <div class=\"widget-header\">\\\n                <div class=\"widget-icon\">\\\n                    <a onclick=\"Portal.Events.tryto_login_oa()\" href=\"javascript:void(0);\" target=\"_blank\"><i class=\"fa fa-fw fa-users\"></i></a>\\\n                </div>\\\n                <div class=\"widget-title\">\\\n                    <a onclick=\"Portal.Events.tryto_login_oa()\" href=\"javascript:void(0);\" target=\"_blank\">电子公文-待办</a>\\\n                </div>\\\n            </div>\\\n            <div class=\"widget-body\">\\\n                <ul>\\\n                    %@\\\n                </ul>\\\n            </div>\\\n      </div>';\n};\nvar arr = [];\nvar arrLength = dataArray.length;\nfor(var i = 0; i < arrLength; i++){\n    if (i > 4){\n        break;\n    }\n    var url = dataArray.eq(i).find(\"URL\").text();\n    var comment = dataArray.eq(i).find(\"Comment\").text();\n    var index = comment.indexOf(\"【状态】：\");\n    var state = comment.substring(index);\n    var subState = state.split(\"：\")[1];\n    var title = dataArray.eq(i).find(\"Title\").text();\n    arr.push(\"<li><a onclick=\\\"Portal.Events.tryto_login_oa(1)\\\" onmouseover=\\\"this.style.backgroundColor='#ade4fc';this.style.color='#2ba4db';\\\" onmouseout=\\\"this.style.backgroundColor='#2ba4db';this.style.color='#fff';\\\" \\\n             style='background-color: #2ba4db;display: block;margin-right: -15px;margin-left: 8px;' href='\"+ url +\"' target='_blank' title='\"+ title \n             +\"'><span class='badge' style=\\\"background:#fff;color:#68c2f1;margin-left: -10px;margin-bottom: 3px;border-radius: 25px;padding: 3px 5px;\\\">\"+ (i+1) \n             +\"</span><span class='text-overflow' style=\\\"padding-left:8px;width:70%\\\">\"+ title \n             +\"</span><i style=\\\"float:right;margin-right: 13px;\\\">\"+ subState +\"</i></a></li>\");\n};\nreturn reValue.replace(\"%@\",arr.join(\"\"));",
            "height": 4
          }
        },
        {
          "type": "plugin531a3b2b7df9e78c7300000f",
          "settings": {
            "html": "var cmsCnpcArray = datasources ? $(datasources[\"CMS_CNPC_GetMyTask\"]).find(\"Table\") : [];// 集团合同\n\nvar expensePtrArray = datasources ? $(datasources[\"EXPENSE_PTR_GetMyTask\"]).find(\"Table1\") : [];// 股份集中报销\n\nvar expenseCnpcArray = datasources ? $(datasources[\"EXPENSE_CNPC_GetMyTask\"]).find(\"Table1\") : [];// 集团集中报销\n\nvar oaPassArray = datasources ? $(datasources[\"OA_PASS_GetMyTask\"]).find(\"Table\") : [];// 电子公文传阅\n\n\n// 集团合同\nPortal.Events.tryto_login_cmsCnpc=function(is_url_href){\n    var returnUrl = \"https://cms.cnpc.petrochina/contractsystem\";\n    var e = window.event || arguments.callee.caller.arguments[0];\n    if(is_url_href){\n        var target = $(e.target);\n        var host = \"\";\n        var re=/^(\\d+)\\.(\\d+)\\.(\\d+)\\.(\\d+)$/;\n\t\tif(target.is(\"a\"))\n            host = new URL(target.attr(\"href\"));        \n        else\n            host = new URL(target.closest(\"a\").attr(\"href\"));\n        var hostname = host.hostname;\n        if(re.test(hostname)){\n        \tif( RegExp.$1<256 && RegExp.$2<256 && RegExp.$3<256 && RegExp.$4<256)   \n        \topenUrl = host.href.replace(hostname,\"cms.cnpc.petrochina\");\n        }else{\n            openUrl = host.href;\n        }\n    }\n    if(Steedos.isNode()){\n        var exec = nw.require('child_process').exec;\n        var app_id = \"Nk6zgMo8L8zsTXrvn\";\n        var aToken = Accounts._storedLoginToken();\n        var uId = Meteor.userId();\n        var eurl = encodeURIComponent(returnUrl);\n        var path = \"api/app/sso/\" + app_id + \"?authToken=\" + aToken + \"&userId=\" + uId + \"&returnUrl=\" + eurl;\n        var openUrl = Meteor.absoluteUrl(path);\n        var cmd = \"start iexplore.exe \\\"\" + openUrl + \"\\\"\";\n        exec(cmd, function(error, stdout, stderr){\n            if(error){\n                toastr.error(error);\n            }\n        });\n    }\n    e.preventDefault();\n    return false;\n}\nvar cmsCnpcArrValue;\nif (cmsCnpcArray.length == 0){\n    cmsCnpcArrValue = '<div class=\"col-md-6\" style=\"padding-left:0px\">\\\n        <div class=\" widget-content\">\\\n            <div class=\"callout callout-info radius-none box-widget\" style=\"height:150px; ; background-color:#68c2f1 !important\">\\\n                <div class=\"widget-header\">\\\n                    <div class=\"widget-icon\"><a onclick=\"Portal.Events.tryto_login_cmsCnpc()\" href=\"http://cms.cnpc.petrochina/contractsystem/Login/Login.aspx\" target=\"_blank\"><i class=\"fa fa-fw fa-clipboard\"></i></a></div>\\\n                    <div class=\"widget-title\"><a onclick=\"Portal.Events.tryto_login_cmsCnpc()\" href=\"http://cms.cnpc.petrochina/contractsystem/Login/Login.aspx\" target=\"_blank\">集团合同</a></div>\\\n                </div>\\\n                <div class=\"widget-body is-empty\">暂无集团合同待办</div>\\\n            </div>\\\n        </div>\\\n\t</div>'\n}else{\n    cmsCnpcArrValue = '<div class=\"col-md-6\" style=\"padding-left:0px\">\\\n        <div class=\" widget-content\">\\\n            <div class=\"callout callout-info radius-none box-widget\" style=\"height:150px;background-color:#68c2f1 !important\">\\\n                <div class=\"widget-header\">\\\n                    <div class=\"widget-icon\"><a onclick=\"Portal.Events.tryto_login_cmsCnpc()\" href=\"http://cms.cnpc.petrochina/contractsystem/Login/Login.aspx\" target=\"_blank\"><i class=\"fa fa-fw fa-clipboard\"></i></a></div>\\\n                    <div class=\"widget-title\"><a onclick=\"Portal.Events.tryto_login_cmsCnpc()\" href=\"http://cms.cnpc.petrochina/contractsystem/Login/Login.aspx\" target=\"_blank\">集团合同</a></div>\\\n                </div>\\\n                <div class=\"widget-body\">\\\n                    <ul>\\\n                        %@\\\n                    </ul>\\\n                </div>\\\n            </div>\\\n        </div>\\\n\t</div>';\n};\n\nvar cmsCnpcArr = [];\nfor(var i = 0; i < cmsCnpcArray.length; i++){\n    if (i > 1){\n        break;\n    }\n    var url = cmsCnpcArray.eq(i).find(\"URL\").text();\n    var title = cmsCnpcArray.eq(i).find(\"Title\").text();\n    cmsCnpcArr.push(\"<li><a onclick='Portal.Events.tryto_login_cmsCnpc(1)' href='\"+ url \n                    +\"' target='_blank' title='\"+ title \n                    +\"'><span class='badge' style=\\\"background:#fff;color:#68c2f1\\\">\"+ (i+1) \n                    +\"</span><span class=\\\"text-overflow\\\" style=\\\"padding-left: 8px;position: absolute;left: 30px;right: 8px;\\\">\"+ title +\"</span></a></li>\");\n};\ncmsCnpcArrValue = cmsCnpcArrValue.replace(\"%@\",cmsCnpcArr.join(\"\"));\n\n\n// 股份集中报销\nPortal.Events.tryto_login_expensePtr=function(is_url_href){\n    var returnUrl = \"\";\n    var e = window.event || arguments.callee.caller.arguments[0];\n    if(is_url_href){\n        var target = $(e.target);\n        var host = \"\";\n        var re=/^(\\d+)\\.(\\d+)\\.(\\d+)\\.(\\d+)$/;\n\t\tif(target.is(\"a\"))\n            host = new URL(target.attr(\"href\"));        \n        else\n            host = new URL(target.closest(\"a\").attr(\"href\"));\n        returnUrl = host.pathname;\n    }\n    if(Steedos.isNode()){\n        var exec = nw.require('child_process').exec;\n        var app_id = \"nHMsG3k26PeB7uDsm\";\n        var aToken = Accounts._storedLoginToken();\n        var uId = Meteor.userId(); \n        var eurl = encodeURIComponent(returnUrl);\n        var path = \"api/app/sso/\" + app_id + \"?authToken=\" + aToken + \"&userId=\" + uId + \"&returnUrl=\" + eurl;\n        var openUrl = Meteor.absoluteUrl(path);\n        var cmd = \"start iexplore.exe \\\"\" + openUrl + \"\\\"\";\n        exec(cmd, function(error, stdout, stderr){\n            if(error){\n                toastr.error(error);\n            }\n        });\n    }\n    e.preventDefault();\n    return false;\n}\nvar expensePtrValue;\nif (expensePtrArray.length == 0){\n    expensePtrValue = '<div class=\"col-md-6\" style=\"padding-right:20px\">\\\n    <div class=\" widget-content\">\\\n        <div class=\"callout callout-warning radius-none box-widget\" style=\"height:150px;background-color:#fda946 !important\">\\\n            <div class=\"widget-header\">\\\n                <div class=\"widget-icon\"><a onclick=\"Portal.Events.tryto_login_expensePtr()\" href=\"http://expense.cnpc/Expense/default.aspx\" target=\"_blank\"><i class=\"fa fa-fw fa-list-alt\"></i></a></div>\\\n                <div class=\"widget-title\"><a onclick=\"Portal.Events.tryto_login_expensePtr()\" href=\"http://expense.cnpc/Expense/default.aspx\" target=\"_blank\">股份集中报销</a></div>\\\n\t\t\t</div>\\\n            <div class=\"widget-body is-empty\">暂无报销待办</div>\\\n\t\t</div>\\\n\t</div>\\\n  </div>'\n}else{\n    expensePtrValue = '<div class=\"col-md-6\" style=\"padding-right:20px\">\\\n    <div class=\" widget-content\">\\\n        <div class=\"callout callout-warning radius-none box-widget\" style=\"height:150px;background-color:#fda946 !important\">\\\n            <div class=\"widget-header\">\\\n                <div class=\"widget-icon\"><a onclick=\"Portal.Events.tryto_login_expensePtr()\" href=\"http://expense.cnpc/Expense/default.aspx\" target=\"_blank\"><i class=\"fa fa-fw fa-list-alt\"></i></a></div>\\\n                <div class=\"widget-title\"><a onclick=\"Portal.Events.tryto_login_expensePtr()\" href=\"http://expense.cnpc/Expense/default.aspx\" target=\"_blank\">股份集中报销</a></div>\\\n            </div>\\\n            <div class=\"widget-body\">\\\n                <ul>\\\n                    %@\\\n                </ul>\\\n            </div>\\\n        </div>\\\n\t</div>\\\n   </div>';\n};\nvar expensePtrArr = [];\nfor(var i = 0; i < expensePtrArray.length; i++){\n    if (i > 1){\n        break;\n    }\n    var url = expensePtrArray.eq(i).find(\"URL\").text();\n    var title = expensePtrArray.eq(i).find(\"Title\").text();\n    expensePtrArr.push(\"<li><a onclick='Portal.Events.tryto_login_expensePtr(1)' href='\"+ url \n                       +\"' target='_blank' title='\"+ title \n                       +\"'><span class=\\\"text-overflow\\\" style=\\\"width:90%\\\">\"+ title +\"</span></a></li>\");\n};\nexpensePtrValue = expensePtrValue.replace(\"%@\",expensePtrArr.join(\"\"));\n\n\n// 集团集中报销\nPortal.Events.tryto_login_expenseCnpc=function(is_url_href){\n    var returnUrl = \"\";\n    var e = window.event || arguments.callee.caller.arguments[0];\n    if(is_url_href){\n        var target = $(e.target);\n        var host = \"\";\n        var re=/^(\\d+)\\.(\\d+)\\.(\\d+)\\.(\\d+)$/;\n\t\tif(target.is(\"a\"))\n            host = new URL(target.attr(\"href\"));        \n        else\n            host = new URL(target.closest(\"a\").attr(\"href\"));\n        returnUrl = host.pathname;\n    }\n    if(Steedos.isNode()){\n        var exec = nw.require('child_process').exec;\n        var app_id = \"N5AGX983LGgEm4a25\";\n        var aToken = Accounts._storedLoginToken();\n        var uId = Meteor.userId(); \n        var eurl = encodeURIComponent(returnUrl);\n        var path = \"api/app/sso/\" + app_id + \"?authToken=\" + aToken + \"&userId=\" + uId + \"&returnUrl=\" + eurl;\n        var openUrl = Meteor.absoluteUrl(path);\n        var cmd = \"start iexplore.exe \\\"\" + openUrl + \"\\\"\";\n        exec(cmd, function(error, stdout, stderr){\n            if(error){\n                toastr.error(error);\n            }\n        });\n    }\n    e.preventDefault();\n    return false;\n}\nvar expenseCnpcValue;\nif (expenseCnpcArray.length == 0){\n    expenseCnpcValue = '<div class=\"col-md-6\" style=\"padding-left:0px\">\\\n    <div class=\" widget-content\">\\\n        <div class=\"callout callout-warning radius-none box-widget\" style=\"height:150px;background-color:#fda946 !important\">\\\n            <div class=\"widget-header\">\\\n                <div class=\"widget-icon\"><a onclick=\"Portal.Events.tryto_login_expenseCnpc()\" href=\"http://expense.cnpc/Expense/default.aspx\" target=\"_blank\"><i class=\"fa fa-fw fa-list-alt\"></i></a></div>\\\n                <div class=\"widget-title\"><a onclick=\"Portal.Events.tryto_login_expenseCnpc()\" href=\"http://expense.cnpc/Expense/default.aspx\" target=\"_blank\">集团集中报销</a></div>\\\n\t\t\t</div>\\\n            <div class=\"widget-body is-empty\">暂无集团报销待办</div>\\\n        </div>\\\n    </div>\\\n  </div>'\n}else{\n    expenseCnpcValue = '<div class=\"col-md-6\" style=\"padding-left:0px\">\\\n        <div class=\" widget-content\">\\\n            <div class=\"callout callout-warning radius-none box-widget\" style=\"height:150px;background-color:#fda946 !important\">\\\n                <div class=\"widget-header\">\\\n                    <div class=\"widget-icon\"><a onclick=\"Portal.Events.tryto_login_expenseCnpc()\" href=\"http://expense.cnpc/Expense/default.aspx\" target=\"_blank\"><i class=\"fa fa-fw fa-list-alt\"></i></a></div>\\\n                    <div class=\"widget-title\"><a onclick=\"Portal.Events.tryto_login_expenseCnpc()\" href=\"http://expense.cnpc/Expense/default.aspx\" target=\"_blank\">集团集中报销</a></div>\\\n\t\t\t\t</div>\\\n                <div class=\"widget-body\">\\\n                    <ul>\\\n                        %@\\\n                    </ul>\\\n                </div>\\\n            </div>\\\n        </div>\\\n      </div>';\n};\nvar expenseCnpcArr = [];\nfor(var i = 0; i < expenseCnpcArray.length; i++){\n    if (i > 1){\n        break;\n    }\n    var url = expenseCnpcArray.eq(i).find(\"URL\").text();\n    var title = expenseCnpcArray.eq(i).find(\"Title\").text();\n    expenseCnpcArr.push(\"<li><a onclick='Portal.Events.tryto_login_expenseCnpc(1)' href='\"+ url \n                        +\"' target='_blank' title='\"+ title \n                        +\"'><span class='text-overflow' style='width:90%'>\"+ title +\"</span></a></li>\");\n};\nexpenseCnpcValue = expenseCnpcValue.replace(\"%@\",expenseCnpcArr.join(\"\"));\n\n\n// 电子公文-传阅\nPortal.Events.tryto_login_oaPass=function(is_url_href){\n    var returnUrl = \"http://oa.petrochina/task%20portal/index.aspx\";\n    var e = window.event || arguments.callee.caller.arguments[0];\n    if(is_url_href){\n        var target = $(e.target);\n        var host = \"\";\n        var re=/^(\\d+)\\.(\\d+)\\.(\\d+)\\.(\\d+)$/;\n\t\tif(target.is(\"a\"))\n            host = new URL(target.attr(\"href\"));        \n        else\n            host = new URL(target.closest(\"a\").attr(\"href\"));\n        var hostname = host.hostname;\n        if(re.test(hostname)){\n        \tif( RegExp.$1<256 && RegExp.$2<256 && RegExp.$3<256 && RegExp.$4<256)   \n        \topenUrl = host.href.replace(hostname,\"oa.petrochina\");\n        }else{\n            openUrl = host.href;\n        }\n    }\n    if(Steedos.isNode()){\n        var exec = nw.require('child_process').exec;\n        var app_id = \"sAxnbGqTQsGNjMpZ8\";\n    \tvar aToken = Accounts._storedLoginToken();\n        var uId = Meteor.userId();\n        var eurl = encodeURIComponent(returnUrl);\n        var path = \"api/app/sso/\" + app_id + \"?authToken=\" + aToken + \"&userId=\" + uId + \"&returnUrl=\" + eurl;\n        var openUrl = Meteor.absoluteUrl(path);\n        var cmd = \"start iexplore.exe \\\"\" + openUrl + \"\\\"\";\n        exec(cmd, function(error, stdout, stderr){\n            if(error){\n                toastr.error(error);\n            }\n        });\n    }\n    e.preventDefault();\n    return false;\n}\nvar oaPassValue;\nif (oaPassArray.length == 0){\n    oaPassValue = '<div class=\"col-md-6\" style=\"padding-right:20px\">\\\n    <div class=\" widget-content\">\\\n        <div class=\"callout callout-info radius-none box-widget\" style=\"height:150px;background-color:#85D3DC !important\">\\\n            <div class=\"widget-header\">\\\n                <div class=\"widget-icon\"><a onclick=\"Portal.Events.tryto_login_oaPass()\" href=\"javascript:void(0);\" target=\"_blank\"><i class=\"fa fa-fw fa-clipboard\"></i></a></div>\\\n                <div class=\"widget-title\"><a onclick=\"Portal.Events.tryto_login_oaPass()\" href=\"javascript:void(0);\" target=\"_blank\">电子公文-传阅</a></div>\\\n\t\t\t</div>\\\n        \t<div class=\"widget-body is-empty\">暂无公文传阅</div>\\\n        </div>\\\n    </div>\\\n  </div>'\n}else{\n    oaPassValue = '<div class=\"col-md-6\" style=\"padding-right:20px\">\\\n    <div class=\" widget-content\">\\\n        <div class=\"callout callout-info radius-none box-widget\" style=\"height:150px;background-color:#85D3DC !important\">\\\n            <div class=\"widget-header\">\\\n                <div class=\"widget-icon\"><a onclick=\"Portal.Events.tryto_login_oaPass()\" href=\"javascript:void(0);\" target=\"_blank\"><i class=\"fa fa-fw fa-clipboard\"></i></a></div>\\\n                <div class=\"widget-title\"><a onclick=\"Portal.Events.tryto_login_oaPass()\" href=\"javascript:void(0);\" target=\"_blank\">电子公文-传阅</a></div>\\\n            </div>\\\n            <div class=\"widget-body\">\\\n                <ul>\\\n                \t%@\\\n                </ul>\\\n            </div>\\\n        </div>\\\n    </div>\\\n   </div>';\n};\nvar oaPassArr = [];\nfor(var i = 0; i < oaPassArray.length; i++){\n    if (i > 1){\n        break;\n    }\n    var url = oaPassArray.eq(i).find(\"URL\").text();\n    var comment = oaPassArray.eq(i).find(\"Comment\").text();\n    var index = comment.indexOf(\"【状态】：\");\n    var state = comment.substring(index);\n    var subState = state.split(\"：\")[1];\n    var title = oaPassArray.eq(i).find(\"Title\").text();\n    oaPassArr.push(\"<li><a onclick=\\\"Portal.Events.tryto_login_oaPass(1)\\\" href='\"+ url \n                   +\"' target='_blank' title='\"+ title \n                   +\"'><span class='text-overflow' style='width:90%'>\"+ title +\"</span></a></li>\");\n};\noaPassValue = oaPassValue.replace(\"%@\",oaPassArr.join(\"\"));\n\nvar Value = cmsCnpcArrValue + expensePtrValue + expenseCnpcValue + oaPassValue;\n\nreturn Value;",
            "height": 4
          }
        }
      ]
    },
    {
      "title": "pane3",
      "width": 1,
      "row": {
        "2": 37,
        "3": 1,
        "4": 37,
        "5": 37,
        "6": 37
      },
      "col": {
        "2": 1,
        "3": 1,
        "4": 3,
        "5": 2,
        "6": 2
      },
      "col_width": "2",
      "widgets": [
        {
          "type": "plugin531a3b2b7df9e78c7300000f",
          "settings": {
            "html": "var reValue = '<div style=\"margin-left:30px\">%@</div>';\n// 管理信息系统\nPortal.Events.tryto_login_erp=function(){\n    var e = window.event || arguments.callee.caller.arguments[0];\n    if(Steedos.isNode()){\n        var exec = nw.require('child_process').exec;\n        var openUrl = \"https://iam.cnpc/erpagent/sapcreater.jsp?appnum=0040401&timestamp=1332818034947\";\n        var cmd = \"start iexplore.exe \\\"\" + openUrl + \"\\\"\";\n        exec(cmd, function(error, stdout, stderr){\n            if(error){\n                toastr.error(error);\n            }\n        });\n    }\n    e.preventDefault();\n    return false;\n}\nvar erpValue = '<div class=\"col-md-6\">\\\n    <div class=\" widget-content\">\\\n        <div class=\"callout callout-info radius-none widget-mini box-widget\" style=\"height:150px;background-color:#67bdeb !important\">\\\n            <div class=\"widget-icon\"><a onclick=\"Portal.Events.tryto_login_erp()\" href=\"https://iam.cnpc/erpagent/sapcreater.jsp?appnum=0040401&timestamp=1332818034947\" target=\"_blank\"><i class=\"fa is-text-icon\">ERP</i></a></div>\\\n            <div class=\"widget-title\"><a onclick=\"Portal.Events.tryto_login_erp()\" href=\"https://iam.cnpc/erpagent/sapcreater.jsp?appnum=0040401&timestamp=1332818034947\" target=\"_blank\">系统</a></div>\\\n        </div>\\\n\t</div>\\\n  </div>';\n\n// 制造执行系统\nPortal.Events.tryto_login_mes=function(){\n    var e = window.event || arguments.callee.caller.arguments[0];\n    if(Steedos.isNode()){\n        var exec = nw.require('child_process').exec;\n        var openUrl = \"https://iam.cnpc/fcshmesjct/website2/dl.aspx\";\n        var cmd = \"start iexplore.exe \\\"\" + openUrl + \"\\\"\";\n        exec(cmd, function(error, stdout, stderr){\n            if(error){\n                toastr.error(error);\n            }\n        });\n    }\n    e.preventDefault();\n    return false;\n}\nvar mesValue = '<div class=\"col-md-6\">\\\n    <div class=\" widget-content\">\\\n        <div class=\"callout callout-info radius-none widget-mini box-widget\" style=\"height:150px;background-color:#55c4cb !important\">\\\n            <div class=\"widget-icon\"><a onclick=\"Portal.Events.tryto_login_mes()\" href=\"https://iam.cnpc/fcshmesjct/website2/dl.aspx\" target=\"_blank\"><i class=\"fa is-text-icon\">MES</i></a></div>\\\n            <div class=\"widget-title\"><a onclick=\"Portal.Events.tryto_login_mes()\" href=\"https://iam.cnpc/fcshmesjct/website2/dl.aspx\" target=\"_blank\">系统</a></div>\\\n        </div>\\\n\t</div>\\\n  </div>';\n  \n// 中油电子邮件\nPortal.Events.tryto_login_email=function(){\n    var loginUrl = \"https://mail.petrochina/user/?q=login.do\";\n    var openUrl = \"https://mail.petrochina/user/?q=base\";\n    var loginSucFun = function(){\n        Steedos.openWindow(openUrl);\n    }\n    if (AccountManager.getAuth()){\n        $.ajax({\n            type: \"POST\",\n            url: loginUrl,\n            data: {\n                \"user\": AccountManager.getAuth().user, //yangfq@petrochina.com.cn\n                \"lang\": \"en_us\",\n                \"password\": AccountManager.getAuth().pass, //123123\n                \"auth_code\": \"\",\n                \"go\": \"https://mail.petrochina/user/?q=base\",\n                \"login_ssl\": 0\n            },\n            success: function(result) {\n                loginSucFun();\n            },\n            error: function() {\n                toastr.error(\"抚顺石化系统登录验证失败，可能链接脚本或域账户设置不正确！\");\n            }\n        });\n    }\n    var e = window.event || arguments.callee.caller.arguments[0];\n    e.preventDefault();\n    return false;\n}\nvar adobeValue = '<div class=\"col-md-6\">\\\n    <div class=\" widget-content\">\\\n        <div class=\"callout callout-info radius-none widget-mini box-widget\" style=\"height:150px;background-color:#84caef !important\">\\\n            <div class=\"widget-icon\"><a onclick=\"Portal.Events.tryto_login_email()\" href=\"https://mail.petrochina/user/?q=base\" target=\"_blank\"><i class=\"fa fa-fw fa-envelope\"></i></a></div>\\\n            <div class=\"widget-title\"><a onclick=\"Portal.Events.tryto_login_email()\" href=\"https://mail.petrochina/user/?q=base\" target=\"_blank\">中油电子邮件</a></div>\\\n        </div>\\\n\t</div>\\\n  </div>';\n  \n// 公司门户\nPortal.Events.tryto_login_fssh=function(){\n    var e = window.event || arguments.callee.caller.arguments[0];\n    if(Steedos.isNode()){\n        var exec = nw.require('child_process').exec;\n        var openUrl = \"http://www.fssh.petrochina/Pages/default.aspx\";\n        var cmd = \"start iexplore.exe \\\"\" + openUrl + \"\\\"\";\n        exec(cmd, function(error, stdout, stderr){\n            if(error){\n                toastr.error(error);\n            }\n        });\n    }\n    e.preventDefault();\n    return false;\n}\nvar userValue = '<div class=\"col-md-6\">\\\n    <div class=\" widget-content\">\\\n        <div class=\"callout callout-info radius-none widget-mini box-widget\" style=\"height:150px;background-color:#fda946 !important\">\\\n            <div class=\"widget-icon\"><a onclick=\"Portal.Events.tryto_login_fssh()\" href=\"http://www.fssh.petrochina/Pages/default.aspx\" target=\"_blank\"><i class=\"fa fa-fw fa-home\"></i></a></div>\\\n            <div class=\"widget-title\"><a onclick=\"Portal.Events.tryto_login_fssh()\" href=\"http://www.fssh.petrochina/Pages/default.aspx\" target=\"_blank\">公司门户</a></div>\\\n        </div>\\\n\t</div>\\\n  </div>';\n  \n// 公务车管理\nPortal.Events.tryto_login_car=function(){\n    var e = window.event || arguments.callee.caller.arguments[0];\n    var openUrl = \"http://10.103.10.130/workflow\";\n    Steedos.openWindow(openUrl);\n    e.preventDefault();\n    return false;\n}\nvar carValue = '<div class=\"col-md-6\">\\\n    <div class=\" widget-content\">\\\n        <div class=\"callout callout-info radius-none widget-mini box-widget\" style=\"height:150px;background-color:#84caef !important\">\\\n            <div class=\"widget-icon\"><a onclick=\"Portal.Events.tryto_login_car()\" href=\"http://10.103.10.144:8080/bus/user!login\" target=\"_blank\"><i class=\"fa fa-fw fa-car\"></i></a></div>\\\n            <div class=\"widget-title\"><a onclick=\"Portal.Events.tryto_login_car()\" href=\"http://10.103.10.144:8080/bus/user!login\" target=\"_blank\">公务车管理</a></div></div>\\\n        </div>\\\n  </div>';\n \n// 会议室预约系统\nPortal.Events.tryto_login_meeting=function(){\n    var e = window.event || arguments.callee.caller.arguments[0];\n    var loginUrl = \"http://10.103.10.144:8080/meeting/user!login\";\n    var openUrl = \"http://10.103.10.144:8080/meeting/user!login?user.userName=\" + Meteor.user().steedos_id.split(\"@\")[0];\n    Steedos.openWindow(openUrl);\n    e.preventDefault();\n    return false;\n}\nvar meetingValue = '<div class=\"col-md-6\">\\\n    <div class=\" widget-content\">\\\n        <div class=\"callout callout-info radius-none widget-mini box-widget\" style=\"height:150px;background-color:#85D3DC !important\">\\\n<div class=\"widget-icon\"><a onclick=\"Portal.Events.tryto_login_meeting()\" href=\"http://10.103.10.144:8080/meeting/user!login\" target=\"_blank\"><i class=\"fa fa-fw fa-pencil-square-o\"></i></a></div>\\\n            <div class=\"widget-title\"><a onclick=\"Portal.Events.tryto_login_meeting()\" href=\"http://10.103.10.144:8080/meeting/user!login\" target=\"_blank\">会议室预约</a></div></div>\\\n        </div>\\\n  </div>';\n  \n  \n// 请销假管理\nvar proValue = '<div class=\"col-md-6\">\\\n    <div class=\" widget-content\">\\\n        <div class=\"callout callout-warning radius-none widget-mini box-widget\" style=\"height:150px;background-color:#85D3DC !important\">\\\n            <div class=\"widget-icon\"><a href=\"http://www.fssh.petrochina/qxj/Pages/default.aspx\" target=\"_blank\"><i class=\"fa fa-fw fa-file-text\"></i></a></div>\\\n            <div class=\"widget-title\"><a href=\"http://www.fssh.petrochina/qxj/Pages/default.aspx\" target=\"_blank\">请销假管理</a></div>\\\n\t\t</div>\\\n\t</div>\\\n  </div>';\n  \n// 个人薪酬查询\nvar personValue = '<div class=\"col-md-6\">\\\n    <div class=\" widget-content\">\\\n        <div class=\"callout callout-info radius-none widget-mini box-widget\" style=\"height:150px;background-color:#67BDEB !important\">\\\n            <div class=\"widget-icon\"><a href=\"http://hr.erp.petrochina:8080/sap/bc/webdynpro/sap/zhr_wd_ee_search_new?sap-language=ZH\" target=\"_blank\"><i class=\"fa fa-fw fa-user\"></i></a></div>\\\n            <div class=\"widget-title\"><a href=\"http://hr.erp.petrochina:8080/sap/bc/webdynpro/sap/zhr_wd_ee_search_new?sap-language=ZH\" target=\"_blank\">个人薪酬查询</a></div>\\\n\t\t</div>\\\n\t</div>\\\n  </div>';\n\n\nvar value = userValue + mesValue + adobeValue + erpValue + carValue + meetingValue + proValue + personValue;\n\nreturn reValue.replace(\"%@\",value); ",
            "height": 4
          }
        }
      ]
    }
  ],
  "datasources": [
    {
      "name": "OA_GetMyTask",
      "type": "plugin52b0be5c88ca16c9ae000005",
      "settings": {
        "url": "http://oa.petrochina/Task%20Portal/Services/ExternalService.asmx",
        "use_thingproxy": false,
        "refresh": 500,
        "method": "POST",
        "body": "<?xml version=\"1.0\" encoding=\"utf-8\"?> <soap:Envelope xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:soap=\"http://schemas.xmlsoap.org/soap/envelope/\">   <soap:Body>     <GetMyTask xmlns=\"http://tempuri.org/\">       <UserName>{{\"ptr\\\\\"+Portal.GetAuthByName(\"ptr\").login_name}}</UserName>       <type>1</type>     </GetMyTask>   </soap:Body> </soap:Envelope>",
        "headers": [
          {
            "name": "Content-Type",
            "value": "text/xml; charset=utf-8"
          },
          {
            "name": "SOAPAction",
            "value": "http://tempuri.org/GetMyTask"
          }
        ],
        "name": "OA_GetMyTask"
      }
    },
    {
      "name": "CMS_PTR_GetMyTask",
      "type": "plugin52b0be5c88ca16c9ae000005",
      "settings": {
        "url": "http://cms.petrochina/CMSInterface/Service/CMSExportData.asmx",
        "use_thingproxy": false,
        "refresh": 500,
        "method": "POST",
        "body": "<?xml version=\"1.0\" encoding=\"utf-8\"?> <soap:Envelope xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:soap=\"http://schemas.xmlsoap.org/soap/envelope/\">   <soap:Body>     <GetMyTask xmlns=\"http://tempuri.org/\">       <UserName>{{\"ptr\\\\\"+Portal.GetAuthByName(\"ptr\").login_name}}</UserName>       <type>1</type>     </GetMyTask>   </soap:Body> </soap:Envelope>",
        "headers": [
          {
            "name": "Content-Type",
            "value": "text/xml; charset=utf-8"
          },
          {
            "name": "SOAPAction",
            "value": "http://tempuri.org/GetMyTask"
          }
        ],
        "name": "CMS_PTR_GetMyTask"
      }
    },
    {
      "name": "CMS_CNPC_GetMyTask",
      "type": "plugin52b0be5c88ca16c9ae000005",
      "settings": {
        "url": "http://cms.cnpc.petrochina/CMSInterface/Service/CMSExportData.asmx",
        "use_thingproxy": false,
        "refresh": 500,
        "method": "POST",
        "body": "<?xml version=\"1.0\" encoding=\"utf-8\"?> <soap:Envelope xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:soap=\"http://schemas.xmlsoap.org/soap/envelope/\">   <soap:Body>     <GetMyTask xmlns=\"http://tempuri.org/\">       <UserName>{{\"cnpc\\\\\"+Portal.GetAuthByName(\"cnpc\").login_name}}</UserName>       <type>1</type>     </GetMyTask>   </soap:Body> </soap:Envelope>",
        "headers": [
          {
            "name": "Content-Type",
            "value": "text/xml; charset=utf-8"
          },
          {
            "name": "SOAPAction",
            "value": "http://tempuri.org/GetMyTask"
          }
        ],
        "name": "CMS_CNPC_GetMyTask"
      }
    },
    {
      "name": "OA_PASS_GetMyTask",
      "type": "plugin52b0be5c88ca16c9ae000005",
      "settings": {
        "url": "http://oa.petrochina/Task%20Portal/Services/ExternalService.asmx",
        "use_thingproxy": false,
        "refresh": 500,
        "method": "POST",
        "body": "<?xml version=\"1.0\" encoding=\"utf-8\"?> <soap:Envelope xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:soap=\"http://schemas.xmlsoap.org/soap/envelope/\">   <soap:Body>     <GetMyTask xmlns=\"http://tempuri.org/\">       <UserName>{{\"ptr\\\\\"+Portal.GetAuthByName(\"ptr\").login_name}}</UserName>       <type>4</type>     </GetMyTask>   </soap:Body> </soap:Envelope>",
        "headers": [
          {
            "name": "Content-Type",
            "value": "text/xml; charset=utf-8"
          },
          {
            "name": "SOAPAction",
            "value": "http://tempuri.org/GetMyTask"
          }
        ],
        "name": "OA_PASS_GetMyTask"
      }
    },
    {
      "name": "EXPENSE_CNPC_GetMyTask",
      "type": "plugin52b0be5c88ca16c9ae000005",
      "settings": {
        "url": "http://expense.cnpc/Expense/service/expensewebservice.asmx/GetMyTask?UserName={{\"cnpc\\\\\"+Portal.GetAuthByName(\"cnpc\").login_name}}&type=-1",
        "use_thingproxy": false,
        "refresh": 500,
        "method": "GET",
        "headers": [
          {
            "name": "Content-Type",
            "value": "text/xml; charset=utf-8"
          }
        ],
        "name": "EXPENSE_CNPC_GetMyTask"
      }
    },
    {
      "name": "EXPENSE_PTR_GetMyTask",
      "type": "plugin52b0be5c88ca16c9ae000005",
      "settings": {
        "url": "http://expense.cnpc/Expense/service/expensewebservice.asmx/GetMyTask?UserName={{\"ptr\\\\\"+Portal.GetAuthByName(\"ptr\").login_name}}&type=-1",
        "use_thingproxy": false,
        "refresh": 500,
        "method": "GET",
        "headers": [
          {
            "name": "Content-Type",
            "value": "text/xml; charset=utf-8"
          }
        ]
      }
    },
    {
      "name": "Workflow_GetSiteAData",
      "type": "plugin52b0be5c88ca16c9ae000005",
      "settings": {
        "url": "http://10.103.10.161/WorkflowInterface/DBWFServices.asmx",
        "use_thingproxy": false,
        "refresh": 500,
        "method": "POST",
        "body": "<?xml version=\"1.0\" encoding=\"utf-8\"?> <soap12:Envelope xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:soap12=\"http://www.w3.org/2003/05/soap-envelope\"> <soap12:Body> <GetSiteAData_xml xmlns=\"http://tempuri.org/\"> <userName>{{Portal.GetAuthByName(\"ptr\").login_name}}</userName> </GetSiteAData_xml> </soap12:Body> </soap12:Envelope>",
        "headers": [
          {
            "name": "Content-Type",
            "value": "application/soap+xml; charset=utf-8"
          }
        ]
      }
    }
  ],
  "columns": 4
}