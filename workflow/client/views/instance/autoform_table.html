<template name="autoform_table">
    
    <div class="panel panel-default">
        <div class="panel-heading">
            <div class="panel-title">{{afFieldLabelText name=this.code}}
                
                {{#if equals this.permission 'editable'}}
                    <div class="pull-right">
                        <span class="panel-controls">
                            <!-- Button trigger modal -->
                            <span class="glyphicon glyphicon-plus add-steedos-table-row" data-rowindex="-1" data-toggle="modal" data-title="新增" data-method="add"></span>
                        </span>
                    </div>
                    {{/if}}
            </div>
        </div>
        <div class="panel-body" style="padding:0px;overflow-x:auto;">
            <table class="table table-bordered table-condensed autoform-table" style='margin-bottom:0px;' name="{{this.code}}table" data-validrows="{{initValidrows this.tableValues}}" data-rowobj = "{{initRowobj this.sfields}}" data-formid="{{this.formId}}" data-rowformula="{{initRowFormula this.sfields}}">
                <thead>
                    <tr>
                    {{#each this.sfields}}
                        {{#if this.is_wide}}
                            <td nowrap="nowrap" style="width:300px;">
                                <label class="control-label">{{this.code}}</label>
                            </td>
                        {{else}}
                            <td nowrap="nowrap" style='width:150px'>
                                <label class="control-label">{{this.code}}</label>
                            </td>
                        {{/if}}
                    {{/each}}
                    </tr>
                </thead>
                {{#if equals this.permission 'editable'}}
                <tbody id='{{this.code}}tbody' data-formcode="{{this.code}}">
                    {{#each this.tableValues}}
                    <tr class="person-row edit-steedos-table-row" data-toggle="modal" name="{{@index}}row" data-rowindex="{{@index}}" data-method="edit" data-title="编辑">
                        {{#each arrayify this}}
                            <td nowrap="nowrap">
                                {{{value}}}
                            </td>
                        {{/each}}<!--
                        <td nowrap="nowrap">
                            <span class="panel-controls">
                                <span class="glyphicon glyphicon-remove remove-steedos-table-row" data-rowindex="{{@index}}"></span>
                                <span class="glyphicon glyphicon-pencil edit-steedos-table-row" data-rowindex="{{@index}}" data-title="修改" data-method="edit"></span>
                            </span>
                        </td>-->
                    </tr>
                    {{/each}}
                </tbody>
                {{else}}
                <tbody id='{{this.code}}tbody' data-formcode="{{this.code}}">
                    {{#each this.tableValues}}
                    <tr class="person-row" data-toggle="modal" name="{{@index}}row" >
                        <td >{{@index}}</td>
                        {{#each arrayify this}}
                            <td nowrap="nowrap">
                                {{{value}}}
                            </td>
                        {{/each}}
                    </tr>
                    {{/each}}
                </tbody>
                {{/if}}
            </table>
        </div>
    </div>
    {{#if equals this.permission 'editable'}}

    <div class="modal fade" id="{{this.code}}modal" name="{{this.code}}.modal" data-rowindex="-1" data-formcode="{{this.code}}">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
              <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                <h4 class="modal-title" id="{{this.code}}-modal-header">编辑</h4>
              </div>
              <div class="modal-body">
                {{> afObjectField name=(append this.code '.$' )}}
              </div>
              <div class="modal-footer">
                <div class="pull-left">
                    <button type="button" class="btn btn-default remove-steedos-table-row">删除</button>
                </div>
                <button type="button" class="btn btn-default" data-dismiss="modal">关闭</button>
                <button type="button" id="steedos-table-ok-button" class="btn btn-primary">好</button>
              </div>
            </div>
        </div>
    </div>

    <div style="display:none">
        {{> afArrayField name=this.code}}
    </div>
    {{/if}}
</template>